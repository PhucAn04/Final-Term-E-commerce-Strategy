@model IEnumerable<Ecommerce.ViewModels.OrderHistoryViewModel>

@{
    ViewData["Title"] = "Order History";
    Layout = "~/Views/Shared/_LayoutCustomer.cshtml";
}

<div class="container my-5">
    <h2 class="text-center fw-bold mb-5 text-primary">
        <i class="bi bi-bag-check-fill me-2"></i> Lịch sử đơn hàng
    </h2>

    @if (!Model.Any())
    {
        <section class="py-5 bg-light">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-md-8 col-lg-6">
                        <div class="card text-center shadow-lg border-0">
                            <div class="card-body p-5">
                                <i class="bi bi-cart-x-fill text-danger mb-4" style="font-size: 4rem;"></i>
                                <h3 class="fw-bold text-secondary">Bạn chưa có đơn hàng nào!</h3>
                                <a href="/" class="btn btn-primary mt-4">
                                    <i class="bi bi-bag-plus me-1"></i> Mua sắm ngay
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    }
    else
    {
        foreach (var order in Model)
        {
            <div class="card shadow-lg border-3 border-primary rounded-3 mb-5">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <span class="px-3 py-1 rounded-pill bg-warning text-dark fw-bold">
                        <i class="bi bi-receipt-cutoff me-1"></i> Đơn hàng #@order.MaHoaDon
                    </span>
                    <span>
                        <i class="bi bi-calendar3 me-1"></i> @order.NgayDatFormatted
                    </span>
                </div>

                <div class="card-body" style="background-color: #f9f9f9;">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <p><strong class="text-primary">Người nhận:</strong> @order.HoTen</p>
                            <p><strong class="text-primary">Địa chỉ:</strong> @order.DiaChi</p>
                            <p><strong class="text-primary">Số điện thoại:</strong> @order.PhoneNumber</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong class="text-primary">Thanh toán:</strong> @order.CachThanhToan</p>
                            <p><strong class="text-primary">Vận chuyển:</strong> @order.CachVanChuyen</p>
                            <p>
                                <strong class="text-primary">Trạng thái:</strong>
                                <span class="badge
                                            @(order.TrangThai == "Hoàn tất" ? "bg-success" :
                                                                            order.TrangThai == "Đang xử lý" ? "bg-warning text-dark" : "bg-info text-dark")">
                            @order.TrangThai
                        </span>
                    </p>
                    <p>
                        <strong class="text-primary">Tổng tiền:</strong>
                        <span class="fw-bold text-danger">@order.TongTienFormatted</span>
                    </p>
                </div>
            </div>

            @if (!string.IsNullOrEmpty(order.GhiChu))
                    {
                        <div class="alert alert-secondary shadow-sm">
                            <i class="bi bi-sticky-fill me-1"></i>
                            <strong>Ghi chú:</strong> @order.GhiChu
                        </div>
                    }

                    <h5 class="fw-bold text-primary mt-4 mb-3">
                        <i class="bi bi-box-seam me-1"></i> Chi tiết sản phẩm
                    </h5>

                    <div class="table-responsive">
                        <table class="table table-bordered table-striped text-center align-middle shadow-sm">
                            <thead class="table-primary">
                                <tr>
                                    <th>Tên sản phẩm</th>
                                    <th>Đơn giá</th>
                                    <th>Số lượng</th>
                                    <th>Giảm giá (%)</th>
                                    <th>Thành tiền</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in order.Items)
                                {
                                    <tr>
                                        <td class="text-start">@item.TenSp</td>
                                        <td>@item.DonGiaFormatted</td>
                                        <td>@item.SoLuongBan</td>
                                        <td>@item.GiamGia</td>
                                        <td class="fw-bold text-danger">@item.ThanhTienFormatted</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        }
    }
</div>

<br />
<br />
<br />